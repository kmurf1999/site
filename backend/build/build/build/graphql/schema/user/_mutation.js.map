{"version":3,"sources":["../../../../graphql/schema/user/_mutation.js"],"names":["Object","defineProperty","exports","value","mutationResolvers","mutationTypes","_apolloServerExpress","require","_model","_interopRequireDefault","obj","__esModule","default","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","error","done","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","err","undefined","_templateObject","data","_taggedTemplateLiteral","strings","raw","slice","freeze","defineProperties","Mutation","gql","signup","_signup","regeneratorRuntime","mark","_callee","_","_ref","email","password","usr","user","wrap","_callee$","_context","prev","next","Error","findOne","sent","setPassword","save","abrupt","toAuthJSON","stop","_x","_x2","login","_login","_callee2","_ref2","_callee2$","_context2","validatePassword","_x3","_x4"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.mutationResolvers = exports.mutationTypes = void 0;\n\nvar _apolloServerExpress = require(\"apollo-server-express\");\n\nvar _model = _interopRequireDefault(require(\"./_model\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  extend type Mutation {\\n    signup(email: String!, password: String!): AuthPayload\\n    login(email: String!, password: String!): AuthPayload\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _taggedTemplateLiteral(strings, raw) {\n  if (!raw) {\n    raw = strings.slice(0);\n  }\n\n  return Object.freeze(Object.defineProperties(strings, {\n    raw: {\n      value: Object.freeze(raw)\n    }\n  }));\n}\n\nvar Mutation = (0, _apolloServerExpress.gql)(_templateObject());\n\nvar mutationTypes = function mutationTypes() {\n  return [Mutation];\n};\n\nexports.mutationTypes = mutationTypes;\nvar mutationResolvers = {\n  Mutation: {\n    signup: function () {\n      var _signup = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(_, _ref) {\n        var email, password, usr, user;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                email = _ref.email, password = _ref.password;\n\n                if (email) {\n                  _context.next = 3;\n                  break;\n                }\n\n                throw new Error(\"No Email\");\n\n              case 3:\n                if (password) {\n                  _context.next = 5;\n                  break;\n                }\n\n                throw new Error(\"No Password\");\n\n              case 5:\n                _context.next = 7;\n                return _model.default.findOne({\n                  email: email\n                });\n\n              case 7:\n                usr = _context.sent;\n\n                if (!usr) {\n                  _context.next = 10;\n                  break;\n                }\n\n                throw new Error(\"Exists\");\n\n              case 10:\n                _context.next = 12;\n                return new _model.default({\n                  email: email\n                });\n\n              case 12:\n                user = _context.sent;\n                user.setPassword(password);\n                user.save();\n                return _context.abrupt(\"return\", user.toAuthJSON());\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function signup(_x, _x2) {\n        return _signup.apply(this, arguments);\n      }\n\n      return signup;\n    }(),\n    login: function () {\n      var _login = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2(_, _ref2) {\n        var email, password, user;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                email = _ref2.email, password = _ref2.password;\n\n                if (email) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                throw new Error(\"No Email\");\n\n              case 3:\n                if (password) {\n                  _context2.next = 5;\n                  break;\n                }\n\n                throw new Error(\"No Password\");\n\n              case 5:\n                _context2.next = 7;\n                return _model.default.findOne({\n                  email: email\n                });\n\n              case 7:\n                user = _context2.sent;\n\n                if (user) {\n                  _context2.next = 10;\n                  break;\n                }\n\n                throw new Error(\"Incorrect Email\");\n\n              case 10:\n                if (user.validatePassword(password)) {\n                  _context2.next = 12;\n                  break;\n                }\n\n                throw new Error(\"Incorrect Password\");\n\n              case 12:\n                return _context2.abrupt(\"return\", user.toAuthJSON());\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function login(_x3, _x4) {\n        return _login.apply(this, arguments);\n      }\n\n      return login;\n    }()\n  }\n};\nexports.mutationResolvers = mutationResolvers;"],"file":"_mutation.js"}