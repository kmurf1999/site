{"version":3,"sources":["../../../graphql/schema/index.js"],"names":["Object","defineProperty","exports","value","default","_fs","_interopRequireDefault","require","_path","_apolloServerExpress","_lodash","_jsonwebtoken","_model","obj","__esModule","_templateObject3","data","_taggedTemplateLiteral","_templateObject2","_templateObject","strings","raw","slice","freeze","defineProperties","_typeof","Symbol","iterator","constructor","prototype","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","error","done","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","err","undefined","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","_createClass","protoProps","staticProps","_possibleConstructorReturn","call","_assertThisInitialized","ReferenceError","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","_inherits","subClass","superClass","create","_setPrototypeOf","p","jwtSecret","process","env","JWT_SECRET","RequireAuthDirective","_SchemaDirectiveVisit","visitFieldDefinition","field","_field$resolve","defaultFieldResolver","role","regeneratorRuntime","mark","_callee","_len","_key","ctx","token","decoded","user","result","_args","wrap","_callee$","_context","prev","next","Array","req","headers","authorization","split","verify","t0","AuthenticationError","findById","id","sent","includes","abrupt","stop","SchemaDirectiveVisitor","Auth","gql","Query","Mutation","resolvers","status","typeDefs","readdirSync","__dirname","filter","dir","indexOf","forEach","tmp","join","merge","push","types","schema","ApolloServer","schemaDirectives","requireAuth","context","_ref2","_default"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _fs = _interopRequireDefault(require(\"fs\"));\n\nvar _path = _interopRequireDefault(require(\"path\"));\n\nvar _apolloServerExpress = require(\"apollo-server-express\");\n\nvar _lodash = require(\"lodash\");\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _model = _interopRequireDefault(require(\"./user/_model\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n  type Mutation {\\n    _empty: String\\n  }\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  type Query {\\n    status: String\\n  }\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  directive @requireAuth(role: Role) on FIELD_DEFINITION\\n  enum Role {\\n    ADMIN\\n    USER\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _taggedTemplateLiteral(strings, raw) {\n  if (!raw) {\n    raw = strings.slice(0);\n  }\n\n  return Object.freeze(Object.defineProperties(strings, {\n    raw: {\n      value: Object.freeze(raw)\n    }\n  }));\n}\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nvar jwtSecret = process.env.JWT_SECRET;\n\nvar RequireAuthDirective =\n/*#__PURE__*/\nfunction (_SchemaDirectiveVisit) {\n  _inherits(RequireAuthDirective, _SchemaDirectiveVisit);\n\n  function RequireAuthDirective() {\n    _classCallCheck(this, RequireAuthDirective);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(RequireAuthDirective).apply(this, arguments));\n  }\n\n  _createClass(RequireAuthDirective, [{\n    key: \"visitFieldDefinition\",\n    value: function visitFieldDefinition(field) {\n      var _field$resolve = field.resolve,\n          resolve = _field$resolve === void 0 ? defaultFieldResolver : _field$resolve;\n      var role = this.args.role;\n      field.resolve =\n      /*#__PURE__*/\n      _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _len,\n            args,\n            _key,\n            ctx,\n            token,\n            decoded,\n            user,\n            result,\n            _args = arguments;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                for (_len = _args.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n                  args[_key] = _args[_key];\n                }\n\n                ctx = args[2];\n\n                if (!(ctx.req && ctx.req.headers.authorization)) {\n                  _context.next = 24;\n                  break;\n                }\n\n                _context.prev = 3;\n                token = ctx.req.headers.authorization.split(\" \")[1];\n                decoded = _jsonwebtoken.default.verify(token, jwtSecret);\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](3);\n                throw new _apolloServerExpress.AuthenticationError(\"You must be signed in to view this resource.\");\n\n              case 11:\n                _context.next = 13;\n                return _model.default.findById(decoded.id);\n\n              case 13:\n                user = _context.sent;\n\n                if (!(role && (!user.role || !user.role.includes(role)))) {\n                  _context.next = 18;\n                  break;\n                }\n\n                throw new _apolloServerExpress.AuthenticationError(\"You are not authorized to view this resource.\");\n\n              case 18:\n                _context.next = 20;\n                return resolve.apply(this, args);\n\n              case 20:\n                result = _context.sent;\n                return _context.abrupt(\"return\", result);\n\n              case 22:\n                _context.next = 25;\n                break;\n\n              case 24:\n                throw new _apolloServerExpress.AuthenticationError(\"You must be signed in to view this resource.\");\n\n              case 25:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[3, 8]]);\n      }));\n    }\n  }]);\n\n  return RequireAuthDirective;\n}(_apolloServerExpress.SchemaDirectiveVisitor);\n\nvar Auth = (0, _apolloServerExpress.gql)(_templateObject());\nvar Query = (0, _apolloServerExpress.gql)(_templateObject2());\nvar Mutation = (0, _apolloServerExpress.gql)(_templateObject3());\nvar resolvers = {\n  Query: {\n    status: function status() {\n      return 'ok';\n    }\n  }\n};\nvar typeDefs = [Query, Mutation, Auth]; // read the current directory and load types and resolvers automatically\n\n_fs.default.readdirSync(__dirname).filter(function (dir) {\n  return dir.indexOf('.') < 0;\n}).forEach(function (dir) {\n  var tmp = require(_path.default.join(__dirname, dir)).default;\n\n  resolvers = (0, _lodash.merge)(resolvers, tmp.resolvers);\n  typeDefs.push(tmp.types);\n});\n\nvar schema = new _apolloServerExpress.ApolloServer({\n  typeDefs: typeDefs,\n  resolvers: resolvers,\n  schemaDirectives: {\n    requireAuth: RequireAuthDirective\n  },\n  context: function context(_ref2) {\n    var req = _ref2.req;\n    return {\n      req: req\n    };\n  }\n});\nvar _default = schema;\nexports.default = _default;"],"file":"index.js"}