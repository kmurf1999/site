{"version":3,"sources":["../../../../graphql/schema/email/_mutation.js"],"names":["Object","defineProperty","exports","value","mutationResolvers","mutationTypes","_apolloServerExpress","require","_mailer","_interopRequireDefault","_model","obj","__esModule","default","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","error","done","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","err","undefined","_templateObject","data","_taggedTemplateLiteral","strings","raw","slice","freeze","defineProperties","hostEmail","process","env","EMAIL_AUTH_USER","Mutation","gql","sendEmail","_sendEmail","regeneratorRuntime","mark","_callee","_","_ref","from","name","message","messageConfig","email","wrap","_callee$","_context","prev","next","Error","to","subject","concat","body","html","sent","sendMail","abrupt","toGraph","stop","_x","_x2"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.mutationResolvers = exports.mutationTypes = void 0;\n\nvar _apolloServerExpress = require(\"apollo-server-express\");\n\nvar _mailer = _interopRequireDefault(require(\"../../../mailer\"));\n\nvar _model = _interopRequireDefault(require(\"./_model\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  extend type Mutation {\\n    sendEmail(name: String!, from: String!, message: String!): Email\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _taggedTemplateLiteral(strings, raw) {\n  if (!raw) {\n    raw = strings.slice(0);\n  }\n\n  return Object.freeze(Object.defineProperties(strings, {\n    raw: {\n      value: Object.freeze(raw)\n    }\n  }));\n}\n\nvar hostEmail = process.env.EMAIL_AUTH_USER;\nvar Mutation = (0, _apolloServerExpress.gql)(_templateObject());\n\nvar mutationTypes = function mutationTypes() {\n  return [Mutation];\n};\n\nexports.mutationTypes = mutationTypes;\nvar mutationResolvers = {\n  Mutation: {\n    sendEmail: function () {\n      var _sendEmail = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(_, _ref) {\n        var from, name, message, messageConfig, email;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                from = _ref.from, name = _ref.name, message = _ref.message;\n\n                if (from) {\n                  _context.next = 3;\n                  break;\n                }\n\n                throw new Error(\"No Email\");\n\n              case 3:\n                if (message) {\n                  _context.next = 5;\n                  break;\n                }\n\n                throw new Error(\"No Message\");\n\n              case 5:\n                if (typeof name === 'undefined') name = '';\n                messageConfig = {\n                  to: 'kmurf1999@gmail.com',\n                  from: hostEmail,\n                  subject: \"Work Email from \".concat(name, \" - \").concat(from),\n                  body: message,\n                  html: \"<p>\".concat(message, \"</p>\")\n                };\n                _context.next = 9;\n                return new _model.default({\n                  from: from,\n                  to: messageConfig.from,\n                  subject: messageConfig.subject,\n                  name: name,\n                  message: message\n                });\n\n              case 9:\n                email = _context.sent;\n                _context.next = 12;\n                return _mailer.default.sendMail(messageConfig, function (err, info) {\n                  if (err) throw new Error(\"Message Send Failure\");\n                });\n\n              case 12:\n                return _context.abrupt(\"return\", email.toGraph());\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function sendEmail(_x, _x2) {\n        return _sendEmail.apply(this, arguments);\n      }\n\n      return sendEmail;\n    }()\n  }\n};\nexports.mutationResolvers = mutationResolvers;"],"file":"_mutation.js"}