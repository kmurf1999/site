{"version":3,"sources":["../../../../graphql/schema/email/_mutation.js"],"names":["Object","defineProperty","exports","value","mutationResolvers","mutationTypes","_apolloServerExpress","require","_mailer","_interopRequireDefault","_model","obj","__esModule","default","hostEmail","process","env","EMAIL_AUTH_USER","Mutation","gql","sendEmail","_","from","name","message","Error","messageConfig","to","subject","body","html","email","sendMail","err","info","toGraph"],"mappings":"AAAA;;AAEAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAC3CC,EAAAA,KAAK,EAAE;AADoC,CAA7C;AAGAD,OAAO,CAACE,iBAAR,GAA4BF,OAAO,CAACG,aAAR,GAAwB,KAAK,CAAzD;;AAEA,IAAIC,oBAAoB,GAAGC,OAAO,CAAC,uBAAD,CAAlC;;AAEA,IAAIC,OAAO,GAAGC,sBAAsB,CAACF,OAAO,CAAC,iBAAD,CAAR,CAApC;;AAEA,IAAIG,MAAM,GAAGD,sBAAsB,CAACF,OAAO,CAAC,UAAD,CAAR,CAAnC;;AAEA,SAASE,sBAAT,CAAgCE,GAAhC,EAAqC;AAAE,SAAOA,GAAG,IAAIA,GAAG,CAACC,UAAX,GAAwBD,GAAxB,GAA8B;AAAEE,IAAAA,OAAO,EAAEF;AAAX,GAArC;AAAwD;;AAE/F,MAAMG,SAAS,GAAGC,OAAO,CAACC,GAAR,CAAYC,eAA9B;AACA,MAAMC,QAAQ,GAAGZ,oBAAoB,CAACa,GAAI;;;;CAA1C;;AAMA,MAAMd,aAAa,GAAG,MAAM,CAACa,QAAD,CAA5B;;AAEAhB,OAAO,CAACG,aAAR,GAAwBA,aAAxB;AACA,MAAMD,iBAAiB,GAAG;AACxBc,EAAAA,QAAQ,EAAE;AACRE,IAAAA,SAAS,EAAE,OAAOC,CAAP,EAAU;AACnBC,MAAAA,IADmB;AAEnBC,MAAAA,IAFmB;AAGnBC,MAAAA;AAHmB,KAAV,KAIL;AACJ,UAAI,CAACF,IAAL,EAAW,MAAM,IAAIG,KAAJ,CAAU,UAAV,CAAN;AACX,UAAI,CAACD,OAAL,EAAc,MAAM,IAAIC,KAAJ,CAAU,YAAV,CAAN;AACd,UAAI,OAAOF,IAAP,KAAgB,WAApB,EAAiCA,IAAI,GAAG,EAAP;AACjC,YAAMG,aAAa,GAAG;AACpBC,QAAAA,EAAE,EAAE,qBADgB;AAEpBL,QAAAA,IAAI,EAAER,SAFc;AAGpBc,QAAAA,OAAO,EAAG,mBAAkBL,IAAK,MAAKD,IAAK,EAHvB;AAIpBO,QAAAA,IAAI,EAAEL,OAJc;AAKpBM,QAAAA,IAAI,EAAG,MAAKN,OAAQ;AALA,OAAtB;AAOA,YAAMO,KAAK,GAAG,MAAM,IAAIrB,MAAM,CAACG,OAAX,CAAmB;AACrCS,QAAAA,IADqC;AAErCK,QAAAA,EAAE,EAAED,aAAa,CAACJ,IAFmB;AAGrCM,QAAAA,OAAO,EAAEF,aAAa,CAACE,OAHc;AAIrCL,QAAAA,IAJqC;AAKrCC,QAAAA;AALqC,OAAnB,CAApB;AAOA,YAAMhB,OAAO,CAACK,OAAR,CAAgBmB,QAAhB,CAAyBN,aAAzB,EAAwC,CAACO,GAAD,EAAMC,IAAN,KAAe;AAC3D,YAAID,GAAJ,EAAS,MAAM,IAAIR,KAAJ,CAAU,sBAAV,CAAN;AACV,OAFK,CAAN;AAGA,aAAOM,KAAK,CAACI,OAAN,EAAP;AACD;AA3BO;AADc,CAA1B;AA+BAjC,OAAO,CAACE,iBAAR,GAA4BA,iBAA5B","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.mutationResolvers = exports.mutationTypes = void 0;\n\nvar _apolloServerExpress = require(\"apollo-server-express\");\n\nvar _mailer = _interopRequireDefault(require(\"../../../mailer\"));\n\nvar _model = _interopRequireDefault(require(\"./_model\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst hostEmail = process.env.EMAIL_AUTH_USER;\nconst Mutation = _apolloServerExpress.gql`\n  extend type Mutation {\n    sendEmail(name: String!, from: String!, message: String!): Email\n  }\n`;\n\nconst mutationTypes = () => [Mutation];\n\nexports.mutationTypes = mutationTypes;\nconst mutationResolvers = {\n  Mutation: {\n    sendEmail: async (_, {\n      from,\n      name,\n      message\n    }) => {\n      if (!from) throw new Error(\"No Email\");\n      if (!message) throw new Error(\"No Message\");\n      if (typeof name === 'undefined') name = '';\n      const messageConfig = {\n        to: 'kmurf1999@gmail.com',\n        from: hostEmail,\n        subject: `Work Email from ${name} - ${from}`,\n        body: message,\n        html: `<p>${message}</p>`\n      };\n      const email = await new _model.default({\n        from,\n        to: messageConfig.from,\n        subject: messageConfig.subject,\n        name,\n        message\n      });\n      await _mailer.default.sendMail(messageConfig, (err, info) => {\n        if (err) throw new Error(\"Message Send Failure\");\n      });\n      return email.toGraph();\n    }\n  }\n};\nexports.mutationResolvers = mutationResolvers;"],"file":"_mutation.js"}