{"version":3,"sources":["../../../../graphql/schema/user/_mutation.js"],"names":["Object","defineProperty","exports","value","mutationResolvers","mutationTypes","_apolloServerExpress","require","_model","_interopRequireDefault","obj","__esModule","default","Mutation","gql","signup","_","email","password","Error","usr","findOne","user","setPassword","save","toAuthJSON","login","validatePassword"],"mappings":"AAAA;;AAEAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAC3CC,EAAAA,KAAK,EAAE;AADoC,CAA7C;AAGAD,OAAO,CAACE,iBAAR,GAA4BF,OAAO,CAACG,aAAR,GAAwB,KAAK,CAAzD;;AAEA,IAAIC,oBAAoB,GAAGC,OAAO,CAAC,uBAAD,CAAlC;;AAEA,IAAIC,MAAM,GAAGC,sBAAsB,CAACF,OAAO,CAAC,UAAD,CAAR,CAAnC;;AAEA,SAASE,sBAAT,CAAgCC,GAAhC,EAAqC;AAAE,SAAOA,GAAG,IAAIA,GAAG,CAACC,UAAX,GAAwBD,GAAxB,GAA8B;AAAEE,IAAAA,OAAO,EAAEF;AAAX,GAArC;AAAwD;;AAE/F,MAAMG,QAAQ,GAAGP,oBAAoB,CAACQ,GAAI;;;;;CAA1C;;AAOA,MAAMT,aAAa,GAAG,MAAM,CAACQ,QAAD,CAA5B;;AAEAX,OAAO,CAACG,aAAR,GAAwBA,aAAxB;AACA,MAAMD,iBAAiB,GAAG;AACxBS,EAAAA,QAAQ,EAAE;AACRE,IAAAA,MAAM,EAAE,OAAOC,CAAP,EAAU;AAChBC,MAAAA,KADgB;AAEhBC,MAAAA;AAFgB,KAAV,KAGF;AACJ,UAAI,CAACD,KAAL,EAAY,MAAM,IAAIE,KAAJ,CAAU,UAAV,CAAN;AACZ,UAAI,CAACD,QAAL,EAAe,MAAM,IAAIC,KAAJ,CAAU,aAAV,CAAN;AACf,YAAMC,GAAG,GAAG,MAAMZ,MAAM,CAACI,OAAP,CAAeS,OAAf,CAAuB;AACvCJ,QAAAA;AADuC,OAAvB,CAAlB;AAGA,UAAIG,GAAJ,EAAS,MAAM,IAAID,KAAJ,CAAU,QAAV,CAAN;AACT,YAAMG,IAAI,GAAG,MAAM,IAAId,MAAM,CAACI,OAAX,CAAmB;AACpCK,QAAAA;AADoC,OAAnB,CAAnB;AAGAK,MAAAA,IAAI,CAACC,WAAL,CAAiBL,QAAjB;AACAI,MAAAA,IAAI,CAACE,IAAL;AACA,aAAOF,IAAI,CAACG,UAAL,EAAP;AACD,KAjBO;AAkBRC,IAAAA,KAAK,EAAE,OAAOV,CAAP,EAAU;AACfC,MAAAA,KADe;AAEfC,MAAAA;AAFe,KAAV,KAGD;AACJ,UAAI,CAACD,KAAL,EAAY,MAAM,IAAIE,KAAJ,CAAU,UAAV,CAAN;AACZ,UAAI,CAACD,QAAL,EAAe,MAAM,IAAIC,KAAJ,CAAU,aAAV,CAAN;AACf,YAAMG,IAAI,GAAG,MAAMd,MAAM,CAACI,OAAP,CAAeS,OAAf,CAAuB;AACxCJ,QAAAA;AADwC,OAAvB,CAAnB;AAGA,UAAI,CAACK,IAAL,EAAW,MAAM,IAAIH,KAAJ,CAAU,iBAAV,CAAN;AACX,UAAI,CAACG,IAAI,CAACK,gBAAL,CAAsBT,QAAtB,CAAL,EAAsC,MAAM,IAAIC,KAAJ,CAAU,oBAAV,CAAN;AACtC,aAAOG,IAAI,CAACG,UAAL,EAAP;AACD;AA9BO;AADc,CAA1B;AAkCAvB,OAAO,CAACE,iBAAR,GAA4BA,iBAA5B","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.mutationResolvers = exports.mutationTypes = void 0;\n\nvar _apolloServerExpress = require(\"apollo-server-express\");\n\nvar _model = _interopRequireDefault(require(\"./_model\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst Mutation = _apolloServerExpress.gql`\n  extend type Mutation {\n    signup(email: String!, password: String!): AuthPayload\n    login(email: String!, password: String!): AuthPayload\n  }\n`;\n\nconst mutationTypes = () => [Mutation];\n\nexports.mutationTypes = mutationTypes;\nconst mutationResolvers = {\n  Mutation: {\n    signup: async (_, {\n      email,\n      password\n    }) => {\n      if (!email) throw new Error(\"No Email\");\n      if (!password) throw new Error(\"No Password\");\n      const usr = await _model.default.findOne({\n        email\n      });\n      if (usr) throw new Error(\"Exists\");\n      const user = await new _model.default({\n        email\n      });\n      user.setPassword(password);\n      user.save();\n      return user.toAuthJSON();\n    },\n    login: async (_, {\n      email,\n      password\n    }) => {\n      if (!email) throw new Error(\"No Email\");\n      if (!password) throw new Error(\"No Password\");\n      const user = await _model.default.findOne({\n        email\n      });\n      if (!user) throw new Error(\"Incorrect Email\");\n      if (!user.validatePassword(password)) throw new Error(\"Incorrect Password\");\n      return user.toAuthJSON();\n    }\n  }\n};\nexports.mutationResolvers = mutationResolvers;"],"file":"_mutation.js"}